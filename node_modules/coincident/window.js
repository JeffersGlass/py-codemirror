const e="2b7f37dd-0f3c-4afb-a444-c83aed8deab7",t="M"+e,n="T"+e,r="object",s="function",a="number",o="string",i="undefined",c="symbol";var l=e=>({value:new Promise((t=>{let n=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");n.onmessage=t,n.postMessage(e)}))})
/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:f,Map:u,SharedArrayBuffer:p,Uint16Array:y}=globalThis,{BYTES_PER_ELEMENT:g}=f,{BYTES_PER_ELEMENT:d}=y,{isArray:w}=Array,{notify:h,wait:b,waitAsync:m}=Atomics,v=new WeakSet,E=new WeakMap,P={value:{then:e=>e()}};let k=0;const M=(t,{parse:n=JSON.parse,stringify:r=JSON.stringify,transform:a,interrupt:o}=JSON)=>{if(!E.has(t)){const i=(n,...r)=>t.postMessage({[e]:r},{transfer:n}),c=typeof o===s?o:o?.handler,M=o?.delay||42,T=new TextDecoder("utf-16"),x=(e,t)=>e?(m||l)(t,0):(c?((e,t,n)=>{for(;"timed-out"===b(e,0,0,t);)n()})(t,M,c):b(t,0),P);let A=!1;E.set(t,new Proxy(new u,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(e,r)=>"then"===r?null:(...e)=>{const s=k++;let o=new f(new p(2*g)),c=[];v.has(e.at(-1)||c)&&v.delete(c=e.pop()),i(c,s,o,r,a?e.map(a):e);const l=t!==globalThis;let u=0;return A&&l&&(u=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${r}(...args) is awaited`)),x(l,o).value.then((()=>{clearTimeout(u);const e=o[1];if(!e)return;const t=d*e;return o=new f(new p(t+t%g)),i([],s,o),x(l,o).value.then((()=>n(T.decode(new y(o.buffer).slice(0,e)))))}))},set(n,o,i){const c=typeof i;if(c!==s)throw new Error(`Unable to assign ${o} as ${c}`);if(!n.size){const s=new u;t.addEventListener("message",(async t=>{const o=t.data?.[e];if(w(o)){t.stopImmediatePropagation();const[e,i,...c]=o;let l;if(c.length){const[t,o]=c;if(n.has(t)){A=!0;try{const c=await n.get(t)(...o);if(void 0!==c){const t=r(a?a(c):c);s.set(e,t),i[1]=t.length}}catch(e){l=e}finally{A=!1}}else l=new Error(`Unsupported action: ${t}`);i[0]=1}else{const t=s.get(e);s.delete(e);for(let e=new y(i.buffer),n=0;n<t.length;n++)e[n]=t.charCodeAt(n)}if(h(i,0),l)throw l}}))}return!!n.set(o,i)}}))}return E.get(t)};M.transfer=(...e)=>(v.add(e),e);const T=new FinalizationRegistry((([e,t,n])=>{n&&console.debug(`Held value ${String(t)} not relevant anymore`),e(t)})),x=Object.create(null),A=(e,t,{debug:n,return:r,token:s=e}=x)=>{const a=r||new Proxy(e,x),o=[a,[t,e,!!n]];return!1!==s&&o.push(s),T.register(...o),a},{defineProperty:S,getOwnPropertyDescriptor:W,getPrototypeOf:O,isExtensible:$,ownKeys:L,preventExtensions:D,set:R,setPrototypeOf:C}=Reflect,{assign:N,create:_}=Object,j=O(Int8Array),B="isArray",U=(e,t)=>{const{get:n,set:r,value:s}=e;return n&&(e.get=t(n)),r&&(e.set=t(r)),s&&(e.value=t(s)),e},I=(e,t)=>[e,t],J=e=>t=>{const n=typeof t;switch(n){case r:if(null==t)return I("null",t);if(t===globalThis)return I(r,null);case s:return e(n,t);case"boolean":case a:case o:case i:case"bigint":return I(n,t);case c:if(z.has(t))return I(n,z.get(t))}throw new Error(`Unable to handle this ${n} type`)},z=new Map(L(Symbol).filter((e=>typeof Symbol[e]===c)).map((e=>[Symbol[e],e]))),K=e=>{for(const[t,n]of z)if(n===e)return t},Y=e=>e;function F(){return this}const H="apply",q="construct",G="defineProperty",Q="deleteProperty",V="get",X="getOwnPropertyDescriptor",Z="getPrototypeOf",ee="has",te="isExtensible",ne="ownKeys",re="preventExtensions",se="set",ae="setPrototypeOf",oe="delete";var ie=((e,t)=>{const n=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;S(EventTarget.prototype,"addEventListener",{value(t,r,...s){return s.at(0)?.invoke&&(n.has(this)||n.set(this,new Map),n.get(this).set(t,[].concat(s[0].invoke)),delete s[0].invoke),e.call(this,t,r,...s)}})}const l=t&&(e=>{const{currentTarget:t,target:r,type:s}=e;for(const a of n.get(t||r)?.get(s)||[])e[a]()});return function(n,f,u,...p){let y=0,g=this?.transform||Y;const d=new Map,w=new Map,{[u]:h}=n,b=p.length?N(_(globalThis),...p):globalThis,m=J(((e,t)=>{if(!d.has(t)){let n;for(;w.has(n=y++););d.set(t,n),w.set(n,e===r?g(t):t)}return I(e,d.get(t))})),v=e=>{h(oe,I(o,e))},E=([e,n])=>{switch(e){case r:if(null==n)return b;if(typeof n===a)return w.get(n);if(!(n instanceof j))for(const e in n)n[e]=E(n[e]);return n;case s:if(typeof n===o){if(!w.has(n)){const e=function(...e){return t&&e.at(0)instanceof Event&&l(...e),h(H,I(s,n),m(this),e.map(m))};return w.set(n,new WeakRef(e)),A(n,v,{return:e,token:!1})}return w.get(n).deref()}return w.get(n);case c:return K(n)}return n},P={[H]:(e,t,n)=>m(e.apply(t,n)),[q]:(e,t)=>m(new e(...t)),[G]:(e,t,n)=>m(S(e,t,n)),[Q]:(e,t)=>m(delete e[t]),[Z]:e=>m(O(e)),[V]:(e,t)=>m(e[t]),[X]:(e,t)=>{const n=W(e,t);return n?I(r,U(n,m)):I(i,n)},[ee]:(e,t)=>m(t in e),[te]:e=>m($(e)),[ne]:e=>I(r,L(e).map(m)),[re]:e=>m(D(e)),[se]:(e,t,n)=>m(R(e,t,n)),[ae]:(e,t)=>m(C(e,t)),[oe](e){d.delete(w.get(e)),w.delete(e)}};return n[f]=(e,t,...n)=>{switch(e){case H:n[0]=E(n[0]),n[1]=n[1].map(E);break;case q:n[0]=n[0].map(E);break;case G:{const[e,t]=n;n[0]=E(e);const{get:r,set:s,value:a}=t;r&&(t.get=E(r)),s&&(t.set=E(s)),a&&(t.value=E(a));break}default:n=n.map(E)}return P[e](E(t),...n)},{proxy:n,[e.toLowerCase()]:b,[`is${e}Proxy`]:()=>!1}}})("Window",!0),ce=(e=>{let t=0;const n=new Map,i=new Map,l=Symbol(),f=e=>typeof e===s?e():e,u=e=>typeof e===r&&!!e&&l in e,p=Array[B];return function(y,g,d){const w=this?.transform||Y,{[g]:h}=y,b=new Map,m=e=>{b.delete(e),h(oe,v(e))},v=J(((e,a)=>{if(l in a)return f(a[l]);if(e===s){if(a=w(a),!i.has(a)){let e;for(;i.has(e=String(t++)););n.set(a,e),i.set(e,a)}return I(e,n.get(a))}if(!(a instanceof j)){e===r&&(a=w(a));for(const e in a)a[e]=v(a[e])}return I(e,a)})),E=e=>{const[t,n]=e;if(!b.has(n)){const r=t===s?F.bind(e):e,a=new Proxy(r,M);return b.set(n,new WeakRef(a)),A(n,m,{return:a,token:!1})}return b.get(n).deref()},P=e=>{const[t,n]=e;switch(t){case r:return null===n?globalThis:typeof n===a?E(e):n;case s:return typeof n===o?i.get(n):E(e);case c:return K(n)}return n},k=(e,t,...n)=>P(h(e,f(t),...n)),M={[H]:(e,t,n)=>k(H,e,v(t),n.map(v)),[q]:(e,t)=>k(q,e,t.map(v)),[G]:(e,t,n)=>{const{get:r,set:a,value:o}=n;return typeof r===s&&(n.get=v(r)),typeof a===s&&(n.set=v(a)),typeof o===s&&(n.value=v(o)),k(G,e,v(t),n)},[Q]:(e,t)=>k(Q,e,v(t)),[Z]:e=>k(Z,e),[V]:(e,t)=>t===l?e:k(V,e,v(t)),[X]:(e,t)=>{const n=k(X,e,v(t));return n&&U(n,P)},[ee]:(e,t)=>t===l||k(ee,e,v(t)),[te]:e=>k(te,e),[ne]:e=>k(ne,e).map(P),[re]:e=>k(re,e),[se]:(e,t,n)=>k(se,e,v(t),v(n)),[ae]:(e,t)=>k(ae,e,v(t))};y[d]=(e,t,r,s)=>{switch(e){case H:return P(t).apply(P(r),s.map(P));case oe:{const e=P(t);n.delete(i.get(e)),i.delete(e)}}};const T=new Proxy([r,null],M),x=T.Array[B];return S(Array,B,{value:e=>u(e)?x(e):p(e)}),{[e.toLowerCase()]:T,[`is${e}Proxy`]:u,proxy:y}}})("Window"),le=typeof Worker===s?Worker:class{};const fe=new WeakMap,ue=(e,...r)=>{const s=M(e,...r);if(!fe.has(s)){const a=e instanceof le?ie:ce;fe.set(s,a.call(r.at(0),s,t,n))}return fe.get(s)};ue.transfer=M.transfer;export{ue as default};
